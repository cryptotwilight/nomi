<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta name="description" content="Miminium Admin Template v.1">
    <meta name="author" content="Isna Nur Azis">
    <meta name="keyword" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Nomi - Welcom</title>

    <!-- start: Css -->
    <link rel="stylesheet" type="text/css" href="asset/css/bootstrap.min.css">

    <!-- plugins -->
    <link rel="stylesheet" type="text/css" href="asset/css/plugins/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="asset/css/plugins/simple-line-icons.css" />
    <link rel="stylesheet" type="text/css" href="asset/css/plugins/animate.min.css" />
    <link rel="stylesheet" type="text/css" href="asset/css/plugins/fullcalendar.min.css" />

    <link href="asset/css/style.css" rel="stylesheet">
    <!-- end: Css -->

    <!--Xrpl -->
    <script src="https://unpkg.com/xrpl@2.0.0/build/xrpl-latest-min.js"></script>

    <!--Ipfs -->
    <script src="https://unpkg.com/ipfs-http-client-lite/dist/index.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://cdn.ethers.io/lib/ethers-5.0.umd.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/ethjs@0.3.4/dist/ethjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>

    <link rel="shortcut icon" href="asset/img/logomi.png">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body id="mimin" class="dashboard boxed container padding-0">
    <!-- start: Header -->
    <nav class="navbar container navbar-default header navbar-fixed-top">
        <div class="col-md-12 nav-wrapper">
            <div class="navbar-header" style="width:100%;">
                <div class="opener-left-menu is-open">
                    <span class="top"></span>
                    <span class="middle"></span>
                    <span class="bottom"></span>
                </div>
                <a href="index.html" class="navbar-brand">
                    <b>NOMI</b>
                </a>

                <ul class="nav navbar-nav search-nav">
                    <li>
                        <div class="search">
                            <span class="fa fa-search icon-search" style="font-size:23px;"></span>
                            <div class="form-group form-animate-text">
                                <input type="text" class="form-text" required>
                                <span class="bar"></span>
                                <label class="label-search">Type anywhere to <b>Search</b> </label>
                            </div>
                        </div>
                    </li>
                </ul>

                <ul class="nav navbar-nav navbar-right user-nav">
                    <li>
                        <button id="connect_xrp" style="margin-top:0px !important;" class="btn-flip btn btn-3d btn-info" data-toggle="modal" data-target="#connect_modal">
                    <div class="flip">
                      <div class="side">
                        Connect Xrp <span class="fa fa-chevron-circle-right"></span>
                      </div>
                      <div class="side back">
                        connect to test net?
                      </div>
                    </div>
                    <span class="icon"></span>
                  </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- end: Header -->

    <div class="container-fluid mimin-wrapper bg-light-grey">

        <!-- start:Left Menu -->
        <div id="left-menu">
            <div class="sub-left-menu scroll">
                <ul class="nav nav-list">
                    <li>
                        <div class="left-bg"></div>
                    </li>
                    <li class="time">
                        <h1 class="animated fadeInLeft">21:00</h1>
                        <p class="animated fadeInRight">Sat,October 1st 2029</p>
                    </li>
                    <li class="ripple"><a href="index.html"><span class="fa fa-dashboard"></span>Dashboard</a></li>
                    <li class="ripple"><a href="pages/nft_gallery.html"><span class="fa fa-image"></span>Gallery</a></li>
                    <li class="ripple"><a href="pages/marketplace.html"><span class="fa fa-cart-plus"></span>Marketplace</a></li>
                    
                </ul>
            </div>
        </div>
        <!-- end: Left Menu -->


        <!-- start: content -->
        <div id="content">
            <div class="panel">
                <div class="panel-body">
                    <div class="col-md-6 col-sm-12">
                        <h3 class="animated fadeInLeft">Welcome to Nomi</h3>
                        <p class="animated fadeInDown">DeFi NFTs on XRPL</p>
                        <span id="show_wallet"></span>
                        <ul class="nav navbar-nav">
                           <!-- SPACE -->
                        </ul>
                    </div>
                    <div class="col-md-6 col-sm-12">


                    </div>
                </div>
            </div>

            <div class="col-md-12" style="padding:20px;">
                <div class="col-md-12 padding-0">
                    <div class="col-md-8 padding-0">
                        <div class="col-md-12 padding-0">
                            <div class="col-md-6">
                                <div class="panel box-v1">
                                    <div class="panel-heading bg-white border-none">
                                        <div class="col-md-6 col-sm-6 col-xs-6 text-left padding-0">
                                            <h4 class="text-left">NFTs You Hold</h4>
                                        </div>
                                        <div class="col-md-6 col-sm-6 col-xs-6 text-right">
                                            <h4>
                                                <span class="icon-user icons icon text-right"></span>
                                            </h4>
                                        </div>
                                    </div>
                                    <div class="panel-body text-center">
                                        <h1>51181,320</h1>
                                        <p>User active</p>
                                        <hr/>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="panel box-v1">
                                    <div class="panel-heading bg-white border-none">
                                        <div class="col-md-6 col-sm-6 col-xs-6 text-left padding-0">
                                            <h4 class="text-left">NFTs Traded</h4>
                                        </div>
                                        <div class="col-md-6 col-sm-6 col-xs-6 text-right">
                                            <h4>
                                                <span class="icon-basket-loaded icons icon text-right"></span>
                                            </h4>
                                        </div>
                                    </div>
                                    <div class="panel-body text-center">
                                        <h1>51181,320</h1>
                                        <p>New Orders</p>
                                        <hr/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="panel box-v4">
                                <div class="panel-heading bg-white border-none">
                                    <h4><span class="icon-picture icons"></span> Mint your Next NFT</h4>
                                </div>
                                <div class="panel-body padding-0">
                                    <div class="col-md-12 box-v4-alert">
                                        <div class="panel">
                                            <div class="panel-body">
                                                <input type="file" id="nft_mint_upload">
                                            </div>
                                        </div>
                                        <div class="col-md-6" style="margin-top:5px;">
                                            <button id="nft_mint_button" class="btn ripple-infinite btn-gradient btn-info">
                                                <div>
                                                  <span>Mint</span>
                                                </div>
                                            </button>
                                        </div>
                                    </div>

                                </div>
                                <div class="panel-body padding-0 bg-white">
                                    <!--Hello  -->
                                    Hello<span id="upload_display"></span>
                                    <table>
                                        <tr>
                                            <thead>File To Mint</thead>
                                            <thead></thead>
                                        </tr>
                                        <tr>
                                            <td>

                                            </td>
                                            <td>



                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="col-md-12 padding-0">
                            <div class="panel box-v2">
                                <div class="panel-heading padding-0">
                                    <img src="asset/img/bg2.jpg" class="box-v2-cover img-responsive" />
                                    <div class="box-v2-detail">
                                        <img src="asset/img/avatar.jpg" class="img-responsive" />
                                        <h4>Akihiko Avaron</h4>
                                    </div>
                                </div>
                                <div class="panel-body">
                                    <div class="col-md-12 padding-0 text-center">
                                        <div class="col-md-4 col-sm-4 col-xs-6 padding-0">
                                            <h3>2.000</h3>
                                            <p>Post</p>
                                        </div>
                                        <div class="col-md-4 col-sm-4 col-xs-6 padding-0">
                                            <h3>2.232</h3>
                                            <p>share</p>
                                        </div>
                                        <div class="col-md-4 col-sm-4 col-xs-12 padding-0">
                                            <h3>4.320</h3>
                                            <p>photos</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-12 padding-0">
                            <!-- SPACE -->
                        </div>

                        <div class="col-md-12 padding-0">
                            <!-- SPACE -->
                        </div>
                    </div>
                </div>

                <div class="col-md-12 card-wrap padding-0">
                    <div class="col-md-6">
                       <!-- SPACE -->
                    </div>

                    <div class="col-md-6">
                      <!-- SPACE -->
                       
                    </div>
                </div>
                <div class="col-md-12">
                    <!-- SPACE -->
                </div>
            </div>
        </div>
        <!-- end: content -->

    </div>
    
    <!-- start: Mobile -->
    <div id="mimin-mobile" class="reverse">
        <div class="mimin-mobile-menu-list">
            <div class="col-md-12 sub-mimin-mobile-menu-list animated fadeInLeft">
                <ul class="nav nav-list">
                    <li class="active ripple">
                        <a class="tree-toggle nav-header">
                            <span class="fa-home fa"></span>Dashboard
                            <span class="fa-angle-right fa right-arrow text-right"></span>
                        </a>
                        <ul class="nav nav-list tree">
                            <li><a href="dashboard-v1.html">Dashboard v.1</a></li>
                            <li><a href="dashboard-v2.html">Dashboard v.2</a></li>
                        </ul>
                    </li>
                    <li class="ripple">
                        <a class="tree-toggle nav-header">
                            <span class="fa-diamond fa"></span>Layout
                            <span class="fa-angle-right fa right-arrow text-right"></span>
                        </a>
                        <ul class="nav nav-list tree">
                            <li><a href="topnav.html">Top Navigation</a></li>
                            <li><a href="boxed.html">Boxed</a></li>
                        </ul>
                    </li>
                    <li class="ripple">
                        <a class="tree-toggle nav-header">
                            <span class="fa-area-chart fa"></span>Charts
                            <span class="fa-angle-right fa right-arrow text-right"></span>
                        </a>
                        <ul class="nav nav-list tree">
                            <li><a href="chartjs.html">ChartJs</a></li>
                            <li><a href="morris.html">Morris</a></li>
                            <li><a href="flot.html">Flot</a></li>
                            <li><a href="sparkline.html">SparkLine</a></li>
                        </ul>
                    </li>
                    <li class="ripple">
                        <a class="tree-toggle nav-header">
                            <span class="fa fa-pencil-square"></span>Ui Elements
                            <span class="fa-angle-right fa right-arrow text-right"></span>
                        </a>
                        <ul class="nav nav-list tree">
                            <li><a href="color.html">Color</a></li>
                            <li><a href="weather.html">Weather</a></li>
                            <li><a href="typography.html">Typography</a></li>
                            <li><a href="icons.html">Icons</a></li>
                            <li><a href="buttons.html">Buttons</a></li>
                            <li><a href="media.html">Media</a></li>
                            <li><a href="panels.html">Panels & Tabs</a></li>
                            <li><a href="notifications.html">Notifications & Tooltip</a></li>
                            <li><a href="badges.html">Badges & Label</a></li>
                            <li><a href="progress.html">Progress</a></li>
                            <li><a href="sliders.html">Sliders</a></li>
                            <li><a href="timeline.html">Timeline</a></li>
                            <li><a href="modal.html">Modals</a></li>
                        </ul>
                    </li>
                    <li class="ripple">
                        <a class="tree-toggle nav-header">
                            <span class="fa fa-check-square-o"></span>Forms
                            <span class="fa-angle-right fa right-arrow text-right"></span>
                        </a>
                        <ul class="nav nav-list tree">
                            <li><a href="formelement.html">Form Element</a></li>
                            <li><a href="#">Wizard</a></li>
                            <li><a href="#">File Upload</a></li>
                            <li><a href="#">Text Editor</a></li>
                        </ul>
                    </li>
                    <li class="ripple">
                        <a class="tree-toggle nav-header">
                            <span class="fa fa-table"></span>Tables
                            <span class="fa-angle-right fa right-arrow text-right"></span>
                        </a>
                        <ul class="nav nav-list tree">
                            <li><a href="datatables.html">Data Tables</a></li>
                            <li><a href="handsontable.html">handsontable</a></li>
                            <li><a href="tablestatic.html">Static</a></li>
                        </ul>
                    </li>
                    <li class="ripple">
                        <a href="calendar.html">
                            <span class="fa fa-calendar-o"></span>Calendar
                        </a>
                    </li>
                    <li class="ripple">
                        <a class="tree-toggle nav-header">
                            <span class="fa fa-envelope-o"></span>Mail
                            <span class="fa-angle-right fa right-arrow text-right"></span>
                        </a>
                        <ul class="nav nav-list tree">
                            <li><a href="mail-box.html">Inbox</a></li>
                            <li><a href="compose-mail.html">Compose Mail</a></li>
                            <li><a href="view-mail.html">View Mail</a></li>
                        </ul>
                    </li>
                    <li class="ripple">
                        <a class="tree-toggle nav-header">
                            <span class="fa fa-file-code-o"></span>Pages
                            <span class="fa-angle-right fa right-arrow text-right"></span>
                        </a>
                        <ul class="nav nav-list tree">
                            <li><a href="forgotpass.html">Forgot Password</a></li>
                            <li><a href="login.html">SignIn</a></li>
                            <li><a href="reg.html">SignUp</a></li>
                            <li><a href="article-v1.html">Article v1</a></li>
                            <li><a href="search-v1.html">Search Result v1</a></li>
                            <li><a href="productgrid.html">Product Grid</a></li>
                            <li><a href="profile-v1.html">Profile v1</a></li>
                            <li><a href="invoice-v1.html">Invoice v1</a></li>
                        </ul>
                    </li>
                    <li class="ripple"><a class="tree-toggle nav-header"><span class="fa "></span> MultiLevel  <span class="fa-angle-right fa right-arrow text-right"></span> </a>
                        <ul class="nav nav-list tree">
                            <li><a href="view-mail.html">Level 1</a></li>
                            <li><a href="view-mail.html">Level 1</a></li>
                            <li class="ripple">
                                <a class="sub-tree-toggle nav-header">
                                    <span class="fa fa-envelope-o"></span> Level 1
                                    <span class="fa-angle-right fa right-arrow text-right"></span>
                                </a>
                                <ul class="nav nav-list sub-tree">
                                    <li><a href="mail-box.html">Level 2</a></li>
                                    <li><a href="compose-mail.html">Level 2</a></li>
                                    <li><a href="view-mail.html">Level 2</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li><a href="credits.html">Credits</a></li>
                </ul>
            </div>
        </div>
    </div>
    <button id="mimin-mobile-menu-opener" class="animated rubberBand btn btn-circle btn-danger">
        <span class="fa fa-bars"></span>
      </button>
    <!-- end: Mobile -->

    <div class="modal fade modal-v2" id="connect_modal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="col-md-3 modal-content-left">
                    <b class="modal-content-left-text-1">XRPL Connecting...</b>
                </div>
                <div class="col-md-9 modal-content-right">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <p>Enter you wallet seed.</p>
                    <input id="modal_seed_field" type="text" class="modal-content-right-text-mail" />

                    <select id="modal_select_field"> 
                    <option value="" selected>Select Network</option>
                    <option value="wss://xls20-sandbox.rippletest.net:51233">DEVNET</option>
                    <option value="wss://s.altnet.rippletest.net:51233">TESTNET</option>
                    <option value="wss://xrplcluster.com">MAINNET</option>
                  </select>
                    <button id="connect_modal_button" class="btn btn-primary" data-dismiss="modal">Connect</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <!-- /.modal -->
    <!-- start: Javascript -->
    <script src="asset/js/jquery.min.js"></script>
    <script src="asset/js/jquery.ui.min.js"></script>
    <script src="asset/js/bootstrap.min.js"></script>


    <!-- plugins -->
    <script src="asset/js/plugins/moment.min.js"></script>
    <script src="asset/js/plugins/fullcalendar.min.js"></script>
    <script src="asset/js/plugins/jquery.nicescroll.js"></script>
    <script src="asset/js/plugins/jquery.vmap.min.js"></script>
    <script src="asset/js/plugins/maps/jquery.vmap.world.js"></script>
    <script src="asset/js/plugins/jquery.vmap.sampledata.js"></script>
    <script src="asset/js/plugins/chart.min.js"></script>
    <script src="asset/js/plugins/dropzone.js"></script>

    <script>
        const ipfs = window.IpfsHttpClientLite('https://ipfs.infura.io:5001')

        console.log("got ipfs: " + ipfs);

        var client;
        var account;

        var connected; 

        const storage = window.localStorage; 

        const modalConnectButton = document.getElementById("connect_modal_button");
        modalConnectButton.addEventListener('click', connectXRPL);
        modalConnectSelect = document.getElementById("modal_select_field");

        const modalSeedField = document.getElementById("modal_seed_field");
        const showWallet = document.getElementById("show_wallet");

        const nftMintButton = document.getElementById("nft_mint_button");
        nftMintButton.addEventListener('click', uploadToIPFSAndMint)

        const nftMintUpload = document.getElementById("nft_mint_upload");

        async function connectXRPL() {
            client = new xrpl.Client(modalConnectSelect.value);
            client.connect()
                .then(function(response) {
                    console.log(client.isConnected());
                    account = xrpl.Wallet.fromSeed(modalSeedField.value);
                    console.log(account);
                    showWallet.innerHTML = "Connected Account ::> " + account.classicAddress;
                    storage.setItem("xrpl_connection", client);
                })
        }

        async function getClientData() {

            client.request({
                    "command": "account_info",
                    "account": test_wallet.address,
                    "ledger_index": "validated"
                })
                .then(function(response) {
                    console.log(response);
                })
                .catch(function(err) {
                    console.log(err);
                })
        }

        var nfts;
        async function listNFTs() {

            client.request({
                    method: "account_nfts",
                    account: account.classicAddress
                })
                .then(function(response) {
                    console.log(response);
                    populateGallery(response);
                })
                .catch(function(err) {
                    console.log(err);
                })
        }

        async function populateGallery(nfts) {

        }

        async function uploadToIPFSAndMint() {
            checkConnected();

            console.log(nftMintUpload.value);
            console.log(nftMintUpload.files[0]);

            var reader = new FileReader();

            reader.readAsArrayBuffer(nftMintUpload.files[0]);

            console.log(reader.result);

            ipfs.add(nftMintUpload.files[0])
                .then(function(response) {
                    console.log(response);
                    var ipfsHash = response[0].value;
                    mintToken(ipfsHash);
                })
                .catch(function(err) {
                    console.log(err);
                })
        }

        async function checkConnected() {
            var connected = storage.getItem("xrpl_connected");
            console.log("connected: " + connected);
            if(connected != true){
              $('#connect_modal').modal('show');
            }
        }

        async function mintToken(ipfsHash) {

            var transactionBlob = {

                TransactionType: "NFTokenMint",
                Account: account.classicAddress,
                URI: xrpl.convertStringToHex(ipfsHash + ""),
                Flags : 8,
                TokenTaxon: 0
            }

            console.log(transactionBlob);

            //var signed = account.sign(transactionBlob);

            //console.log("Identifying hash:", signed.hash);
            //console.log("Signed blob:", signed.tx_blob);

            var wallet = account; 
            client.submitAndWait(transactionBlob, {wallet})
                .then(function(response) {
                    console.log(response);
                })
                .catch(function(err) {
                    console.log(err);
                })
        }
    </script>

    <!-- custom -->
    <script src="asset/js/main.js"></script>
    <script type="text/javascript">


            //  end:  Chart =============

            // start: Calendar =========
         
  
            // end : Calendar==========

            // start: Maps============

    </script>
    <!-- end: Javascript -->
</body>

</html>